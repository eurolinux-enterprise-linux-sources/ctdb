From 57f15e7cbcaa6524bd3696fe87f9a7f67adae1f5 Mon Sep 17 00:00:00 2001
From: Sumit Bose <sbose@redhat.com>
Date: Mon, 19 Nov 2012 11:13:03 +0100
Subject: [PATCH] Fix memory leak in ctdb_send_message()

---
 client/ctdb_client.c | 6 +-----
 1 Datei geändert, 1 Zeile hinzugefügt(+), 5 Zeilen entfernt(-)

diff --git a/client/ctdb_client.c b/client/ctdb_client.c
index 94fc712..ed0d07f 100644
--- a/client/ctdb_client.c
+++ b/client/ctdb_client.c
@@ -526,12 +526,8 @@ int ctdb_send_message(struct ctdb_context *ctdb, uint32_t pnn,
 	memcpy(&r->data[0], data.dptr, data.dsize);
 	
 	res = ctdb_client_queue_pkt(ctdb, &r->hdr);
-	if (res != 0) {
-		return res;
-	}
-
 	talloc_free(r);
-	return 0;
+	return res;
 }
 
 
-- 
1.7.11.7

